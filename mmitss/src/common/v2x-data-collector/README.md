# V2X Data Collector

V2X-Data-Collector allows to store the information contained in messages generated by various MMITSS components, on both: roadside and vehicleside processors. 

## Work-flow

On startup, V2X-Data-Collector creates a directory tree (if it does not exist): `/nojournal/bin/v2x-data`. In the `v2x-data` directory, two additional directories are created: `archive` and `<host-name>_MMDDYYYY_HHMMSS`, where `MMDDYYYY_HHMMSS` corresponds to the time of creation of this folder and `host-name` is read from the `["IntersectionName"]` key of the `/nojournal/bin/mmitss-phase3-master-config.json` file. 

Inside the `<host-name>_MMDDYYYY_HHMMSS` directory, a unique file for each message type is created which stores the information from corresponding messages. The filenames follow the convention: `<host-name>_<message type>Log_MMDDYYYY_HHMMSS.csv`. At the midnight of each day, or when the application is exited, the `<host-name>_MMDDYYYY_HHMMSS` directory is moved to the `/nojournal/bin/v2x-data/archive/` directory. Further, if the application continues to run, at the midnight of each day, after archiving the previous day's directory, new `<host-name>_MMDDYYYY_HHMMSS` directory is created in the `/nojournal/bin/v2x-data/` folder with message type-specific unique files that were described earlier.

The suppliers of various data types depend on the deployment processor (roadside or vehicleside) and are summarized in the following table:
| **Data Type** | **Supplier (roadside)** | **Supplier (vehicleside)** |
| --- | --- | --- |
| SPaT | Map-Spat-Broadcaster | Message Decoder |
| Remote BSMs | Message Decoder | Message Decoder |
| SRM | Message Decoder | Priority Request Generator |
| SSM | Priority Request Server | Message Decoder | 
| Message Count | Multiple | Multiple | 
| Host BSMs | N/A | Host BSM Decoder |

## Console output and logging
The V2X-Data-Collector does not produce any console output. The data log files are generated as explained in the earlier section.

## Configuration
In the `/nojournal/bin/mmitss-phase3-master-config.json` file, following field must be configured for the V2X-Data-Collector:
1. `["IntersectionName"]`: A `string` representing the name of the intersection. For vehicleside deploymentm this field can contain string `"vehicle"`.
2. `["ApplicationPlatfom"]`: A `string` indicating the application platform. Allowed values: `"roadside"` or `"vehicle"`
3. `["HostIp"]`: A `string` specifying the IPv4 address of the host machine or the container
4. `["PortNumber"]["DataCollector"]`: an `int` specifying the UDP port used by the V2X-Data-Collector

## Requirements
None

## Known issues/limitations
None
